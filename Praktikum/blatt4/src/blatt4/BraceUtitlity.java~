package blatt4;

import java.io.*;
import java.util.Deque;
import java.util.LinkedList;

public class BraceUtitlity {

    public static void printBrackets(String fn) throws FileNotFoundException, IOException {
        LineNumberReader in = new LineNumberReader(new FileReader(fn));
        String line;
        while ((line = in.readLine()) != null) {
            System.out.println(line);
            System.out.print("Klammern: ");
            for (int i = 0; i < line.length(); i++) {
                char c = line.charAt(i);
                switch (c) {
                    case '(':
                    case '{':
                    case '[':
                        System.out.print(c + ", ");
                        break;
                    case ')':
                    case '}':
                    case ']':
                        System.out.print(c + ", ");
                        break;
                }
            }
            System.out.println();
        }
        in.close();
    }

    public static void checkBrackets(String fn) throws FileNotFoundException, IOException {
        LineNumberReader in = new LineNumberReader(new FileReader(fn));
        Deque<Character> stack = new LinkedList<Character>(); // JDK 1.2 Collections
        
        String line;
        while ((line = in.readLine()) != null) {
        	System.out.println(line);
        	
        	for (int i = 0; i < line.length(); i++) {
        		char letter = line.charAt(i);
    		    if(letter == '{' || letter == '(' || letter == '[' ) {
            	    stack.push(letter);
    		    }
    		
    		    if(letter == '}' || letter == ')' || letter == ']' ) {
    			      if(stack.isEmpty()) {
    			    	  System.out.println("**************Klammer fehlt**********"); // für alle oder 3 if Bedingungen jeweils (für jede Klammersorte)!
    			    	  return ;
    			      }
    		    char klammerImStack = stack.peek();
                if((letter == '}' && klammerImStack == '{') || 
            			(letter == ')' && klammerImStack == '(' )|| 
            				(letter == ']' && klammerImStack == '[') ) {
            	    	stack.pop();
    		  	}else {
    		  		      System.out.println("***********Klammerpaar nicht passend************");
    		  	    	  return;
    		  	      }	
    		  	if(!stack.isEmpty()) {
		            	System.out.println("*******Stack ist NICHT leer :********" + " *** First bracket : *** " + stack.getFirst() + " "
				                        	+ " *** Last bracket : *** " + stack.getLast());
	            }			
		
		    
            }	
                
          in.close();
    }


    public static void main(String[] args) throws FileNotFoundException, IOException {

    //	printBrackets(args[0]);

    	checkBrackets(args[0]);
    }

}
